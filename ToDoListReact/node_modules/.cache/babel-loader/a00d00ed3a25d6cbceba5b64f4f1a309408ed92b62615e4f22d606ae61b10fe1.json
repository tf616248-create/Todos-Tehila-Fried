{"ast":null,"code":"import axios from \"axios\";\nconst apiUrl = \"http://localhost:5024/api\";\n\n// יצירת instance של axios\nconst apiClient = axios.create({\n  baseURL: apiUrl\n  // withCredentials: true\n});\n\n// --- מוסיפים JWT ל־headers אם קיים ---\napiClient.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"token\"); // שם זהה לשימוש שלך בלוגין\n  if (token) {\n    config.headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// --- Interceptor לטיפול בשגיאות 401 ---\napiClient.interceptors.response.use(response => response, error => {\n  if (error.response && error.response.status === 401) {\n    console.warn(\"Unauthorized! Redirecting to login...\");\n    window.location.href = \"/login\";\n  }\n  return Promise.reject(error);\n});\nexport const api = {\n  // רישום משתמש חדש\n  register(username, password) {\n    return apiClient.post(\"/users/register\", {\n      username,\n      password\n    });\n  },\n  // התחברות משתמש\n  // login(username, password) {\n  //   // return apiClient.post(\"/users/login\", { username, password }, { withCredentials: true });\n  //   return apiClient.post(\"/users/login\", { username, password });\n\n  // },\n\n  // שליפת משימות (דורש JWT)\n  getTasks: async () => {\n    const res = await apiClient.get(\"/items\");\n    return res.data;\n  },\n  // הוספת משימה חדשה\n  addTask: async name => {\n    const res = await apiClient.post(\"/items\", {\n      name,\n      isComplete: false\n    });\n    return res.data;\n  },\n  setCompleted: async (id, isComplete) => {\n    return apiClient.patch(`/items/${id}`, {\n      isComplete\n    });\n  }\n};","map":{"version":3,"names":["axios","apiUrl","apiClient","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","response","error","status","console","warn","window","location","href","Promise","reject","api","register","username","password","post","getTasks","res","get","data","addTask","name","isComplete","setCompleted","id","patch"],"sources":["C:/Users/user1/Documents/תכנות תשפו/פרקטי-קוד/3/ToDoListReact/src/service.js"],"sourcesContent":["import axios from \"axios\";\n\nconst apiUrl = \"http://localhost:5024/api\";\n\n// יצירת instance של axios\nconst apiClient = axios.create({\n  baseURL: apiUrl,\n  // withCredentials: true\n});\n\n// --- מוסיפים JWT ל־headers אם קיים ---\napiClient.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"token\"); // שם זהה לשימוש שלך בלוגין\n  if (token) {\n    config.headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// --- Interceptor לטיפול בשגיאות 401 ---\napiClient.interceptors.response.use(\n  response => response,\n  error => {\n    if (error.response && error.response.status === 401) {\n      console.warn(\"Unauthorized! Redirecting to login...\");\n      window.location.href = \"/login\";\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport const api = {\n  // רישום משתמש חדש\n  register(username, password) {\n    return apiClient.post(\"/users/register\", { username, password });\n  },\n  \n  // התחברות משתמש\n  // login(username, password) {\n  //   // return apiClient.post(\"/users/login\", { username, password }, { withCredentials: true });\n  //   return apiClient.post(\"/users/login\", { username, password });\n\n  // },\n\n  // שליפת משימות (דורש JWT)\n  getTasks: async () => {\n    const res = await apiClient.get(\"/items\");\n    return res.data;\n  },\n\n  // הוספת משימה חדשה\n  addTask: async (name) => {\n    const res = await apiClient.post(\"/items\", { name, isComplete: false });\n    return res.data;\n  },\n  setCompleted: async (id, isComplete) => {\n    return apiClient.patch(`/items/${id}`, { isComplete });\n  },\n};\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,MAAM,GAAG,2BAA2B;;AAE1C;AACA,MAAMC,SAAS,GAAGF,KAAK,CAACG,MAAM,CAAC;EAC7BC,OAAO,EAAEH;EACT;AACF,CAAC,CAAC;;AAEF;AACAC,SAAS,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CAACC,MAAM,IAAI;EAC3C,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;EAC7C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACI,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUH,KAAK,EAAE;EACrD;EACA,OAAOD,MAAM;AACf,CAAC,CAAC;;AAEF;AACAN,SAAS,CAACG,YAAY,CAACQ,QAAQ,CAACN,GAAG,CACjCM,QAAQ,IAAIA,QAAQ,EACpBC,KAAK,IAAI;EACP,IAAIA,KAAK,CAACD,QAAQ,IAAIC,KAAK,CAACD,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;IACnDC,OAAO,CAACC,IAAI,CAAC,uCAAuC,CAAC;IACrDC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;EACjC;EACA,OAAOC,OAAO,CAACC,MAAM,CAACR,KAAK,CAAC;AAC9B,CACF,CAAC;AAED,OAAO,MAAMS,GAAG,GAAG;EACjB;EACAC,QAAQA,CAACC,QAAQ,EAAEC,QAAQ,EAAE;IAC3B,OAAOxB,SAAS,CAACyB,IAAI,CAAC,iBAAiB,EAAE;MAAEF,QAAQ;MAAEC;IAAS,CAAC,CAAC;EAClE,CAAC;EAED;EACA;EACA;EACA;;EAEA;;EAEA;EACAE,QAAQ,EAAE,MAAAA,CAAA,KAAY;IACpB,MAAMC,GAAG,GAAG,MAAM3B,SAAS,CAAC4B,GAAG,CAAC,QAAQ,CAAC;IACzC,OAAOD,GAAG,CAACE,IAAI;EACjB,CAAC;EAED;EACAC,OAAO,EAAE,MAAOC,IAAI,IAAK;IACvB,MAAMJ,GAAG,GAAG,MAAM3B,SAAS,CAACyB,IAAI,CAAC,QAAQ,EAAE;MAAEM,IAAI;MAAEC,UAAU,EAAE;IAAM,CAAC,CAAC;IACvE,OAAOL,GAAG,CAACE,IAAI;EACjB,CAAC;EACDI,YAAY,EAAE,MAAAA,CAAOC,EAAE,EAAEF,UAAU,KAAK;IACtC,OAAOhC,SAAS,CAACmC,KAAK,CAAC,UAAUD,EAAE,EAAE,EAAE;MAAEF;IAAW,CAAC,CAAC;EACxD;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}